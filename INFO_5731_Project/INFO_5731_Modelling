{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"mount_file_id":"12b1c43_whqe83jF-6wQJZQ--oZJC9Ox1","authorship_tag":"ABX9TyPKUu5nl9217D5ssiX3xKNA"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"75cb85c1cf1a4d0787b8e08ca32a239c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_09f035100852479f9998745dd78dc758","IPY_MODEL_ca8f7312fa384817af329fc135f52185","IPY_MODEL_611dd8e6658a471cbbaa6bf97682e241"],"layout":"IPY_MODEL_401c8165cd3d4d548fdf0bbe3711e004"}},"09f035100852479f9998745dd78dc758":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a46f11b5ef4d41b7b5500102854c274a","placeholder":"​","style":"IPY_MODEL_fe01dea95cf54c11b174cfa8c432757e","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"ca8f7312fa384817af329fc135f52185":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4232f6bffe9947d399568ac08c6cd47d","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d01a2240c57541c1a53a98093e9ccf01","value":231508}},"611dd8e6658a471cbbaa6bf97682e241":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f82a92aab01749e88ae3a81dccc9eba2","placeholder":"​","style":"IPY_MODEL_633b70267c614880987166b4b908623c","value":" 232k/232k [00:00&lt;00:00, 1.92MB/s]"}},"401c8165cd3d4d548fdf0bbe3711e004":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a46f11b5ef4d41b7b5500102854c274a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe01dea95cf54c11b174cfa8c432757e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4232f6bffe9947d399568ac08c6cd47d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d01a2240c57541c1a53a98093e9ccf01":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f82a92aab01749e88ae3a81dccc9eba2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"633b70267c614880987166b4b908623c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e1a01a891c064c109121e528d9f781a3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_32cfd07d199c4194bbb319aa39bd6884","IPY_MODEL_a801ca307caa42ba8d9c733f724b008a","IPY_MODEL_c2807328c020473c82d8349317b95dbd"],"layout":"IPY_MODEL_a5a784cb53924984bae4dacdec4b0631"}},"32cfd07d199c4194bbb319aa39bd6884":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eed36e75ecfe489fb7ddd9ee54e26804","placeholder":"​","style":"IPY_MODEL_9c0395cf242943709122a158a9d185dd","value":"Downloading (…)okenizer_config.json: 100%"}},"a801ca307caa42ba8d9c733f724b008a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_02cab6378ab94f8fb421e40f8ce791c1","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7476fe2dc65040539a4af5a9f3a4eb04","value":28}},"c2807328c020473c82d8349317b95dbd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ce36bac5b2ca474bb3e055aa5ddc03ae","placeholder":"​","style":"IPY_MODEL_2fa08d3af5dc4178a1b6a09c32ca6285","value":" 28.0/28.0 [00:00&lt;00:00, 853B/s]"}},"a5a784cb53924984bae4dacdec4b0631":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eed36e75ecfe489fb7ddd9ee54e26804":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9c0395cf242943709122a158a9d185dd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"02cab6378ab94f8fb421e40f8ce791c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7476fe2dc65040539a4af5a9f3a4eb04":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ce36bac5b2ca474bb3e055aa5ddc03ae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2fa08d3af5dc4178a1b6a09c32ca6285":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"28577a2ef9ac4658a6b7be56f09170f8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b34e5a46485a4a1b88e69413658e552e","IPY_MODEL_af041889afc24ab3ae90c0e41dacf487","IPY_MODEL_db263dac18cb498db71f6677d1d49cfb"],"layout":"IPY_MODEL_e7c9119e108b4690826bea05e1a2be9c"}},"b34e5a46485a4a1b88e69413658e552e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_19178a6ee0ec49cf8d3f31be6c924e14","placeholder":"​","style":"IPY_MODEL_23fab0f2d8c1412a9b089cd6f4d420f2","value":"Downloading (…)lve/main/config.json: 100%"}},"af041889afc24ab3ae90c0e41dacf487":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f69afbdb26914110988cd263921ff4a4","max":570,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0ba13997ddce499bb5b2d5058972be32","value":570}},"db263dac18cb498db71f6677d1d49cfb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e25aff384619431990c106fc8858722b","placeholder":"​","style":"IPY_MODEL_5a137b4dbe21465daa166122660aef44","value":" 570/570 [00:00&lt;00:00, 16.2kB/s]"}},"e7c9119e108b4690826bea05e1a2be9c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"19178a6ee0ec49cf8d3f31be6c924e14":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23fab0f2d8c1412a9b089cd6f4d420f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f69afbdb26914110988cd263921ff4a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ba13997ddce499bb5b2d5058972be32":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e25aff384619431990c106fc8858722b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a137b4dbe21465daa166122660aef44":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a8666076241d46db9619387844813dcc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1a5b65d7f57b4c4289091d5cc68d4a63","IPY_MODEL_8289fff86d734dec8c17a6c51852512b","IPY_MODEL_4502ee83f4834bb882277feadc718fe5"],"layout":"IPY_MODEL_a385c63f9b44407cb90d1aea4a3fd829"}},"1a5b65d7f57b4c4289091d5cc68d4a63":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_245cf715d9b84604b2c59a7963260d8d","placeholder":"​","style":"IPY_MODEL_34d748a3b5aa4aa6ad4f81fe45e02b29","value":"Downloading pytorch_model.bin: 100%"}},"8289fff86d734dec8c17a6c51852512b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d0fc3d243d54bc38a937b4f6ced0bb3","max":440473133,"min":0,"orientation":"horizontal","style":"IPY_MODEL_679a59d55bee4920abc580fd54fcf5b2","value":440473133}},"4502ee83f4834bb882277feadc718fe5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a9f0c201831747408b968aec397f70f8","placeholder":"​","style":"IPY_MODEL_7e9dc6a1b10f4a188c6b6968a25c39d5","value":" 440M/440M [00:02&lt;00:00, 162MB/s]"}},"a385c63f9b44407cb90d1aea4a3fd829":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"245cf715d9b84604b2c59a7963260d8d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"34d748a3b5aa4aa6ad4f81fe45e02b29":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0d0fc3d243d54bc38a937b4f6ced0bb3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"679a59d55bee4920abc580fd54fcf5b2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a9f0c201831747408b968aec397f70f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e9dc6a1b10f4a188c6b6968a25c39d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# Country Image Evaluation by Aspect Based Sentiment Analysis\n"],"metadata":{"id":"pd4HLuvLoB_n"}},{"cell_type":"code","source":["# installing libraries\n","!pip install transformers"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8qUnJPlMPlUZ","executionInfo":{"status":"ok","timestamp":1683580562342,"user_tz":300,"elapsed":15942,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"d3ddd75e-4760-40a6-874b-b5b2505b0691"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.28.1-py3-none-any.whl (7.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.0/7.0 MB\u001b[0m \u001b[31m55.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0,>=0.11.0\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m19.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m74.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers) (4.5.0)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers) (2023.4.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.15)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.14.1 tokenizers-0.13.3 transformers-4.28.1\n"]}]},{"cell_type":"code","source":["# Imports\n","\n","import pandas as pd\n","import numpy as np\n","\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","from torch.utils.data import Dataset, DataLoader\n","\n","from transformers import BertModel, BertTokenizer\n","\n","from collections import OrderedDict\n"],"metadata":{"id":"Iq0QqnnGPaw5","executionInfo":{"status":"ok","timestamp":1683580563420,"user_tz":300,"elapsed":1080,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["# Load dataset into a Pandas DataFrame\n","\n","df_train = pd.read_csv(\"/content/drive/MyDrive/Colab Notebooks/INFO_5731_Project/cleaned_train_text.csv\", header=0)\n","df_predict = pd.read_csv(\"/content/drive/MyDrive/Colab Notebooks/INFO_5731_Project/cleaned_predict_text.csv\", header=0)\n","\n","# df_train.drop(columns=['Unnamed: 0'], inplace=True)\n","# df_predict.drop(columns=['Unnamed: 0'], inplace=True)\n","\n","\n","df_train.shape, df_predict.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6bXL1E8cQL9r","executionInfo":{"status":"ok","timestamp":1683580741914,"user_tz":300,"elapsed":2533,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"6111b4d2-0d0b-4fe9-aa47-f68984c8d677"},"execution_count":7,"outputs":[{"output_type":"execute_result","data":{"text/plain":["((193, 10), (134201, 6))"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["df_train.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":354},"id":"K2X84LT-pdDi","executionInfo":{"status":"ok","timestamp":1683580748213,"user_tz":300,"elapsed":211,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"80125e05-2cee-4d0c-d4cf-356c48967caa"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                           Full Text Sentiment       Domain  \\\n","0  RT @StephenMcDonell #China’s Henan province to...  negative  twitter.com   \n","1  RT @Bsintash #VirusThreatInCamps We call all i...   neutral  twitter.com   \n","2  RT @RT_com #Spain confirms first case of fast-...   neutral  twitter.com   \n","3  @kerrya11en That is amazing and cute.I am 100%...  positive  twitter.com   \n","4  RT @VistaPResearch United joins Delta and Amer...   neutral  twitter.com   \n","\n","      Date Page Type  Country Character  Country Competence  People Character  \\\n","0  59:36.0   twitter                0.0                 0.0              -1.0   \n","1  58:18.0   twitter               -1.0                 0.0               0.0   \n","2  57:39.0   twitter                0.0                 0.0               0.0   \n","3  56:54.0   twitter                0.0                 0.0               1.0   \n","4  56:46.0   twitter                0.0                -1.0               0.0   \n","\n","   People Competence                                               text  \n","0                0.0  china s henan province today everywhere we re ...  \n","1                0.0  virusthreatincamps call international media ou...  \n","2               -1.0  spain confirms first case fastspreading corona...  \n","3                0.0  amazing cutei supporting guys hope fight virus...  \n","4                0.0  united joins delta american halting flights ch...  "],"text/html":["\n","  <div id=\"df-a5cf20a5-4834-4ba1-8269-2b0c9ccbe151\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Full Text</th>\n","      <th>Sentiment</th>\n","      <th>Domain</th>\n","      <th>Date</th>\n","      <th>Page Type</th>\n","      <th>Country Character</th>\n","      <th>Country Competence</th>\n","      <th>People Character</th>\n","      <th>People Competence</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>RT @StephenMcDonell #China’s Henan province to...</td>\n","      <td>negative</td>\n","      <td>twitter.com</td>\n","      <td>59:36.0</td>\n","      <td>twitter</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>0.0</td>\n","      <td>china s henan province today everywhere we re ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>RT @Bsintash #VirusThreatInCamps We call all i...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>58:18.0</td>\n","      <td>twitter</td>\n","      <td>-1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>virusthreatincamps call international media ou...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>RT @RT_com #Spain confirms first case of fast-...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>57:39.0</td>\n","      <td>twitter</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>spain confirms first case fastspreading corona...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>@kerrya11en That is amazing and cute.I am 100%...</td>\n","      <td>positive</td>\n","      <td>twitter.com</td>\n","      <td>56:54.0</td>\n","      <td>twitter</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>amazing cutei supporting guys hope fight virus...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>RT @VistaPResearch United joins Delta and Amer...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>56:46.0</td>\n","      <td>twitter</td>\n","      <td>0.0</td>\n","      <td>-1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>united joins delta american halting flights ch...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a5cf20a5-4834-4ba1-8269-2b0c9ccbe151')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a5cf20a5-4834-4ba1-8269-2b0c9ccbe151 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a5cf20a5-4834-4ba1-8269-2b0c9ccbe151');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["df_predict.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"JwAl7Qr6peyn","executionInfo":{"status":"ok","timestamp":1683580748422,"user_tz":300,"elapsed":3,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"5d49a5a3-c8c3-49f0-8072-fbc309262053"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                           Full Text Sentiment       Domain  \\\n","0  AMANPURI EXCHANGE has the highest referral fee...   neutral  twitter.com   \n","1  RT @SenRubioPress While the #coronavirus sprea...   neutral  twitter.com   \n","2  RT @cjwerleman “Our only sin was having accept...   neutral  twitter.com   \n","3  RT @le_french_mulu For the people who want to ...  negative  twitter.com   \n","4  RT @SenRubioPress Confirmed #coronavirus cases...   neutral  twitter.com   \n","\n","      Date Page Type                                               text  \n","0  00:23.0   twitter  amanpuri exchange highest referral fee industr...  \n","1  00:22.0   twitter  coronavirus spreads must continue take necessa...  \n","2  00:14.0   twitter  our sin accepted islam we re religious family ...  \n","3  00:14.0   twitter  people want know like empty mall china coronav...  \n","4  00:04.0   twitter  confirmed coronavirus cases xinjiang highlight...  "],"text/html":["\n","  <div id=\"df-a311c308-1af9-4d04-84a2-6448ce1338bf\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Full Text</th>\n","      <th>Sentiment</th>\n","      <th>Domain</th>\n","      <th>Date</th>\n","      <th>Page Type</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>AMANPURI EXCHANGE has the highest referral fee...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:23.0</td>\n","      <td>twitter</td>\n","      <td>amanpuri exchange highest referral fee industr...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>RT @SenRubioPress While the #coronavirus sprea...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:22.0</td>\n","      <td>twitter</td>\n","      <td>coronavirus spreads must continue take necessa...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>RT @cjwerleman “Our only sin was having accept...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>our sin accepted islam we re religious family ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>RT @le_french_mulu For the people who want to ...</td>\n","      <td>negative</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>people want know like empty mall china coronav...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>RT @SenRubioPress Confirmed #coronavirus cases...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:04.0</td>\n","      <td>twitter</td>\n","      <td>confirmed coronavirus cases xinjiang highlight...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a311c308-1af9-4d04-84a2-6448ce1338bf')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a311c308-1af9-4d04-84a2-6448ce1338bf button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a311c308-1af9-4d04-84a2-6448ce1338bf');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":9}]},{"cell_type":"code","source":["predict_df = pd.DataFrame(df_predict['text'])\n","predict_df.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"UjSyBlyAVvo2","executionInfo":{"status":"ok","timestamp":1683580748817,"user_tz":300,"elapsed":4,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"931617f0-4b13-401a-dccd-8c84923ebc82"},"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                text\n","0  amanpuri exchange highest referral fee industr...\n","1  coronavirus spreads must continue take necessa...\n","2  our sin accepted islam we re religious family ...\n","3  people want know like empty mall china coronav...\n","4  confirmed coronavirus cases xinjiang highlight..."],"text/html":["\n","  <div id=\"df-6dc9a9f4-cd78-4288-a5f9-fff0c86ca87e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>amanpuri exchange highest referral fee industr...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>coronavirus spreads must continue take necessa...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>our sin accepted islam we re religious family ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>people want know like empty mall china coronav...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>confirmed coronavirus cases xinjiang highlight...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6dc9a9f4-cd78-4288-a5f9-fff0c86ca87e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-6dc9a9f4-cd78-4288-a5f9-fff0c86ca87e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-6dc9a9f4-cd78-4288-a5f9-fff0c86ca87e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["predict_df.columns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fcJ_GqJJXXVC","executionInfo":{"status":"ok","timestamp":1683580748989,"user_tz":300,"elapsed":2,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"658a4ca5-8ccd-4b20-e379-f08b2da201d9"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['text'], dtype='object')"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["df_train.columns"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aFbuwLbbRSXO","executionInfo":{"status":"ok","timestamp":1683580749476,"user_tz":300,"elapsed":3,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"3aeac88d-e4cd-4cfa-edbb-5f90c4d5e538"},"execution_count":12,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Index(['Full Text', 'Sentiment', 'Domain', 'Date', 'Page Type',\n","       'Country Character', 'Country Competence', 'People Character',\n","       'People Competence', 'text'],\n","      dtype='object')"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["# data['text'] = data['text_modified']\n","\n","# data.drop(columns=['Unnamed: 0', 'Full Text', 'Sentiment', 'text_modified'], inplace=True)\n","# data.columns\n","# data"],"metadata":{"id":"7nXF7tHtQ09W","executionInfo":{"status":"ok","timestamp":1683580750407,"user_tz":300,"elapsed":1,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":13,"outputs":[]},{"cell_type":"markdown","source":["# Implementation"],"metadata":{"id":"Yky7Ae8akWbS"}},{"cell_type":"code","source":["# Generating input_ids and attention_mask for the BERT transformer\n","\n","class AspectDetectionDataset(Dataset):\n","    def __init__(self, data, tokenizer):\n","        self.data = data\n","        self.tokenizer = tokenizer\n","\n","    def __len__(self):\n","        return len(self.data)\n","\n","    def __getitem__(self, idx):\n","        text = self.data.loc[idx, 'text']\n","        aspects = self.data.loc[idx, ['Country Character', 'Country Competence', 'People Character', 'People Competence']].values\n","        tokens = self.tokenizer.encode_plus(text, add_special_tokens=True, return_tensors='pt')\n","        return {'input_ids': tokens['input_ids'].squeeze(0), 'attention_mask': tokens['attention_mask'].squeeze(0), 'aspects': aspects}\n"],"metadata":{"id":"jwIz7k2TPf13","executionInfo":{"status":"ok","timestamp":1683580752124,"user_tz":300,"elapsed":345,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["# Using Pre-trained BERT model for Sentiment detection for the predefined aspects\n","\n","class AspectDetectionModel(nn.Module):\n","    def __init__(self, input_size, num_aspects):\n","        super(AspectDetectionModel, self).__init__()\n","        self.bert = BertModel.from_pretrained('bert-base-uncased')\n","        self.linear = nn.Linear(input_size, num_aspects)\n","        self.sigmoid = nn.Sigmoid()\n","\n","    def forward(self, input_ids, attention_mask):\n","        # Pass input through BERT encoder\n","        outputs = self.bert(input_ids=input_ids, attention_mask=attention_mask)\n","        tweet_representation = outputs.last_hidden_state.mean(dim=1)\n","\n","        # Pass tweet representation through linear layer and sigmoid activation function\n","        out = self.linear(tweet_representation)\n","        out = self.sigmoid(out)\n","\n","        return out"],"metadata":{"id":"Hb4-_ju5QGw4","executionInfo":{"status":"ok","timestamp":1683580752124,"user_tz":300,"elapsed":2,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["# Define training parameters\n","num_epochs = 5\n","batch_size = 32\n","learning_rate = 0.0001\n","\n","# Parameters\n","MAX_LEN = 128\n","BATCH_SIZE = 32"],"metadata":{"id":"tKK2ScXoQKAz","executionInfo":{"status":"ok","timestamp":1683580752361,"user_tz":300,"elapsed":239,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["# Tokenize dataset\n","tokenizer = BertTokenizer.from_pretrained('bert-base-uncased')\n","dataset = AspectDetectionDataset(df_train, tokenizer)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["75cb85c1cf1a4d0787b8e08ca32a239c","09f035100852479f9998745dd78dc758","ca8f7312fa384817af329fc135f52185","611dd8e6658a471cbbaa6bf97682e241","401c8165cd3d4d548fdf0bbe3711e004","a46f11b5ef4d41b7b5500102854c274a","fe01dea95cf54c11b174cfa8c432757e","4232f6bffe9947d399568ac08c6cd47d","d01a2240c57541c1a53a98093e9ccf01","f82a92aab01749e88ae3a81dccc9eba2","633b70267c614880987166b4b908623c","e1a01a891c064c109121e528d9f781a3","32cfd07d199c4194bbb319aa39bd6884","a801ca307caa42ba8d9c733f724b008a","c2807328c020473c82d8349317b95dbd","a5a784cb53924984bae4dacdec4b0631","eed36e75ecfe489fb7ddd9ee54e26804","9c0395cf242943709122a158a9d185dd","02cab6378ab94f8fb421e40f8ce791c1","7476fe2dc65040539a4af5a9f3a4eb04","ce36bac5b2ca474bb3e055aa5ddc03ae","2fa08d3af5dc4178a1b6a09c32ca6285","28577a2ef9ac4658a6b7be56f09170f8","b34e5a46485a4a1b88e69413658e552e","af041889afc24ab3ae90c0e41dacf487","db263dac18cb498db71f6677d1d49cfb","e7c9119e108b4690826bea05e1a2be9c","19178a6ee0ec49cf8d3f31be6c924e14","23fab0f2d8c1412a9b089cd6f4d420f2","f69afbdb26914110988cd263921ff4a4","0ba13997ddce499bb5b2d5058972be32","e25aff384619431990c106fc8858722b","5a137b4dbe21465daa166122660aef44"]},"id":"f5LszTChrmkB","executionInfo":{"status":"ok","timestamp":1683580753453,"user_tz":300,"elapsed":1093,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"61bd1fb4-192a-41b3-be55-f7767e25d28c"},"execution_count":17,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"75cb85c1cf1a4d0787b8e08ca32a239c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e1a01a891c064c109121e528d9f781a3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"28577a2ef9ac4658a6b7be56f09170f8"}},"metadata":{}}]},{"cell_type":"code","source":["# Create data loader\n","dataloader = DataLoader(dataset, batch_size=batch_size, shuffle=True)"],"metadata":{"id":"MLCNT1P7rpXL","executionInfo":{"status":"ok","timestamp":1683580753633,"user_tz":300,"elapsed":2,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["# Create an instance of the model\n","model = AspectDetectionModel(input_size=768, num_aspects=4)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":123,"referenced_widgets":["a8666076241d46db9619387844813dcc","1a5b65d7f57b4c4289091d5cc68d4a63","8289fff86d734dec8c17a6c51852512b","4502ee83f4834bb882277feadc718fe5","a385c63f9b44407cb90d1aea4a3fd829","245cf715d9b84604b2c59a7963260d8d","34d748a3b5aa4aa6ad4f81fe45e02b29","0d0fc3d243d54bc38a937b4f6ced0bb3","679a59d55bee4920abc580fd54fcf5b2","a9f0c201831747408b968aec397f70f8","7e9dc6a1b10f4a188c6b6968a25c39d5"]},"id":"2JqkNyb6rsmO","executionInfo":{"status":"ok","timestamp":1683580760259,"user_tz":300,"elapsed":6627,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"61fa935d-107d-4671-a738-00a335e124b3"},"execution_count":19,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/440M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a8666076241d46db9619387844813dcc"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.bias', 'cls.predictions.bias', 'cls.predictions.transform.dense.weight', 'cls.seq_relationship.weight']\n","- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}]},{"cell_type":"code","source":["# Define loss function and optimizer\n","criterion = nn.BCELoss()\n","optimizer = optim.Adam(model.parameters(), lr=learning_rate)"],"metadata":{"id":"r4cPQ0mssAVO","executionInfo":{"status":"ok","timestamp":1683580760259,"user_tz":300,"elapsed":4,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","execution_count":21,"metadata":{"id":"ZaXezY1SPVNH","executionInfo":{"status":"ok","timestamp":1683580760259,"user_tz":300,"elapsed":3,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"outputs":[],"source":["# Model training\n","def train(model, train_loader, num_epochs, optimizer, criterion):\n","    model.train()\n","    for epoch in range(num_epochs):\n","        running_loss = 0.0\n","        for i, batch in enumerate(train_loader):\n","            input_ids = batch['input_ids']\n","            attention_mask = batch['attention_mask']\n","            labels = batch['labels']\n","            optimizer.zero_grad()\n","\n","            # Forward pass\n","            outputs = model(input_ids=input_ids, attention_mask=attention_mask)\n","            loss = criterion(outputs, labels)\n","\n","            # Backward pass and optimization\n","            loss.backward()\n","            optimizer.step()\n","\n","            # Print running loss\n","            running_loss += loss.item()\n","            if (i+1) % 10 == 0:\n","                batch_loss = running_loss / 10\n","                print(f\"Epoch [{epoch+1}/{num_epochs}], Batch [{i+1}], Loss: {batch_loss:.4f}\")\n","                running_loss = 0.0\n","\n","    print('Finished training')\n","\n","    return model"]},{"cell_type":"code","source":["# Prediction\n","def predict(model, data_loader):\n","    model.eval()\n","    preds = []\n","    with torch.no_grad():\n","        for batch in data_loader:\n","            input_ids = batch['input_ids']\n","            attention_mask = batch['attention_mask']\n","\n","            # Forward pass\n","            outputs = model(input_ids=input_ids, attention_mask=attention_mask)\n","            preds.append(outputs.cpu().numpy())\n","\n","    return np.concatenate(preds, axis=0)\n"],"metadata":{"id":"F4M4ySU5T9fa","executionInfo":{"status":"ok","timestamp":1683580760260,"user_tz":300,"elapsed":4,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["# Create Data Loder\n","\n","def create_data_loader(df, tokenizer, max_len, batch_size):\n","    ds = AspectDetectionDataset(\n","        texts=df['text'].to_numpy(),\n","        aspects=df['aspect'].to_numpy(),\n","        labels=df['label'].to_numpy(),\n","        tokenizer=tokenizer,\n","        max_len=max_len\n","    )\n","    return DataLoader(\n","        ds,\n","        batch_size=batch_size,\n","        shuffle=True,\n","        num_workers=4\n","    )\n"],"metadata":{"id":"r22mNtA6Utss","executionInfo":{"status":"ok","timestamp":1683580760260,"user_tz":300,"elapsed":4,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","source":["# Dataframe to store the results\n","df_result = pd.DataFrame(columns=['Country Character', 'Country Competence', 'People Character', 'People Competence', 'Tweet'])\n"],"metadata":{"id":"88MArNCcmDPi","executionInfo":{"status":"ok","timestamp":1683585467612,"user_tz":300,"elapsed":129,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":82,"outputs":[]},{"cell_type":"code","source":["df_result.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":49},"id":"WCPkKNo_S8zB","executionInfo":{"status":"ok","timestamp":1683585467842,"user_tz":300,"elapsed":5,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"fd658c14-c4e4-4950-e221-d5094c834cb1"},"execution_count":83,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Empty DataFrame\n","Columns: [Country Character, Country Competence, People Character, People Competence, Tweet]\n","Index: []"],"text/html":["\n","  <div id=\"df-c376e2e1-044a-42ea-b042-70955f71effe\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Country Character</th>\n","      <th>Country Competence</th>\n","      <th>People Character</th>\n","      <th>People Competence</th>\n","      <th>Tweet</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c376e2e1-044a-42ea-b042-70955f71effe')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c376e2e1-044a-42ea-b042-70955f71effe button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c376e2e1-044a-42ea-b042-70955f71effe');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":83}]},{"cell_type":"code","source":["# result_dict = {'Country Character': [],\n","#               'Country Competence': [],\n","#               'People Character': [],\n","#               'People Competence': []\n","#               }"],"metadata":{"id":"__zbEXKKr_lM","executionInfo":{"status":"ok","timestamp":1683585468319,"user_tz":300,"elapsed":181,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":84,"outputs":[]},{"cell_type":"code","source":["#  Function to make predictions on a single tweet\n","\n","label_names = ['Country Character', 'Country Competence', 'People Character', 'People Competence']\n","\n","def predict_sentiment(tweet_text,max_length=64):\n","\n","    # Tokenize the tweet text and add the special tokens\n","    encoded_tweet = tokenizer.encode_plus(\n","        tweet_text,                      \n","        add_special_tokens=True,        \n","        max_length=max_length,          \n","        padding='max_length',           \n","        truncation=True,                \n","        return_attention_mask=True,     \n","        return_tensors='pt',            \n","    )\n","\n","    input_ids = encoded_tweet['input_ids']\n","    attention_mask = encoded_tweet['attention_mask']\n","\n","    # Make a forward pass to get the model's output logits\n","    with torch.no_grad():\n","        outputs = model(input_ids, attention_mask=attention_mask)\n","\n","    # Convert the output logits to probabilities\n","    probabilities = torch.softmax(outputs, dim=1)\n","\n","    # Get the predicted sentiment labels\n","    predicted_labels = [label_names[i] for i in torch.topk(probabilities, k=4).indices.tolist()[0]]\n","    # Coverting probailities from tensor datatype to numpy\n","    probabilities = probabilities.numpy()\n","\n","\n","    # Formating the output as a single row to appened it to the result Dataframe\n","    one_row = {\n","        predicted_labels[0]:probabilities[0][0],\n","        predicted_labels[1]:probabilities[0][1],\n","        predicted_labels[2]:probabilities[0][2],\n","        predicted_labels[3]:probabilities[0][3]\n","        # 'Tweet' : tweet_text  \n","    }\n","    # Sorting the record based on Key Values\n","    od_row = OrderedDict(sorted(one_row.items()))\n","    # Getting row values in list format\n","    row_values = list(od_row.values())\n","\n","    # Converting probabilites into sentiments\n","    # row_sentiments =row_values\n","    row_sentiments = list(map(lambda x: -1 if x <= 0.20 else (0 if (x > 0.20 and x <= 0.30) else 1), row_values))\n","    # row_sentiments = list(map(lambda x: -1 if x <= 0.23 else (0 if (x > 0.23 and x <= 0.24) else 1), row_values))\n","\n","    # Appending tweet_text to row_sentiments \n","    row_sentiments.append(tweet_text)\n","\n","    # Appending row to result Dataframe\n","    df_result.loc[len(df_result.index)] = row_sentiments \n","\n","    return 0"],"metadata":{"id":"AgvZ9S3lsEng","executionInfo":{"status":"ok","timestamp":1683585468320,"user_tz":300,"elapsed":4,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":85,"outputs":[]},{"cell_type":"code","source":["# Calling predict function for every tweet\n","\n","_ = predict_df['text'][:10000].apply(predict_sentiment)\n","\n","\n","# for i in range(0, predict_df.shape[0], 1000):\n","#   start_index = df_result2.shape[0]\n","  # df_result2 = predict_df['text'][start_index:i].apply(predict_sentiment)"],"metadata":{"id":"stR6oiSOS6gL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_result.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"Kw3s_9zGSho8","executionInfo":{"status":"ok","timestamp":1683583864801,"user_tz":300,"elapsed":185,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"65db08b6-1473-4935-a032-6f1e73910766"},"execution_count":70,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Country Character  Country Competence  People Character  People Competence  \\\n","0                  1                   1                 1                  1   \n","1                  1                   1                 1                  0   \n","2                  1                   0                 1                  1   \n","3                  1                   0                 1                  1   \n","4                  1                   1                 1                  0   \n","\n","                                               Tweet  \n","0  amanpuri exchange highest referral fee industr...  \n","1  coronavirus spreads must continue take necessa...  \n","2  our sin accepted islam we re religious family ...  \n","3  people want know like empty mall china coronav...  \n","4  confirmed coronavirus cases xinjiang highlight...  "],"text/html":["\n","  <div id=\"df-4e3cd4e8-2eef-4643-aed8-e9024739224e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Country Character</th>\n","      <th>Country Competence</th>\n","      <th>People Character</th>\n","      <th>People Competence</th>\n","      <th>Tweet</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>amanpuri exchange highest referral fee industr...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>coronavirus spreads must continue take necessa...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>our sin accepted islam we re religious family ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>people want know like empty mall china coronav...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>confirmed coronavirus cases xinjiang highlight...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4e3cd4e8-2eef-4643-aed8-e9024739224e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4e3cd4e8-2eef-4643-aed8-e9024739224e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4e3cd4e8-2eef-4643-aed8-e9024739224e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":70}]},{"cell_type":"code","source":["print(df_result['Country Character'].value_counts())\n","print(df_result['Country Competence'].value_counts())\n","print(df_result['People Character'].value_counts())\n","print(df_result['People Competence'].value_counts())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SglDmDMJVIWv","executionInfo":{"status":"ok","timestamp":1683584025621,"user_tz":300,"elapsed":107,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"951d57b4-4d91-488d-aefe-0752a611b902"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stdout","text":["1    890\n","0    110\n","Name: Country Character, dtype: int64\n"," 1    642\n"," 0    338\n","-1     20\n","Name: Country Competence, dtype: int64\n","1    892\n","0    108\n","Name: People Character, dtype: int64\n"," 1    682\n"," 0    312\n","-1      6\n","Name: People Competence, dtype: int64\n"]}]},{"cell_type":"code","source":["df_predict.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"bkPFb_Z6xHP4","executionInfo":{"status":"ok","timestamp":1683584066449,"user_tz":300,"elapsed":118,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"dbacdb92-049c-4812-b7b1-b0f0b2e26f72"},"execution_count":73,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                           Full Text Sentiment       Domain  \\\n","0  AMANPURI EXCHANGE has the highest referral fee...   neutral  twitter.com   \n","1  RT @SenRubioPress While the #coronavirus sprea...   neutral  twitter.com   \n","2  RT @cjwerleman “Our only sin was having accept...   neutral  twitter.com   \n","3  RT @le_french_mulu For the people who want to ...  negative  twitter.com   \n","4  RT @SenRubioPress Confirmed #coronavirus cases...   neutral  twitter.com   \n","\n","      Date Page Type                                               text  \n","0  00:23.0   twitter  amanpuri exchange highest referral fee industr...  \n","1  00:22.0   twitter  coronavirus spreads must continue take necessa...  \n","2  00:14.0   twitter  our sin accepted islam we re religious family ...  \n","3  00:14.0   twitter  people want know like empty mall china coronav...  \n","4  00:04.0   twitter  confirmed coronavirus cases xinjiang highlight...  "],"text/html":["\n","  <div id=\"df-b0ee8ceb-7130-45cb-8273-287c8ea0a159\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Full Text</th>\n","      <th>Sentiment</th>\n","      <th>Domain</th>\n","      <th>Date</th>\n","      <th>Page Type</th>\n","      <th>text</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>AMANPURI EXCHANGE has the highest referral fee...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:23.0</td>\n","      <td>twitter</td>\n","      <td>amanpuri exchange highest referral fee industr...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>RT @SenRubioPress While the #coronavirus sprea...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:22.0</td>\n","      <td>twitter</td>\n","      <td>coronavirus spreads must continue take necessa...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>RT @cjwerleman “Our only sin was having accept...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>our sin accepted islam we re religious family ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>RT @le_french_mulu For the people who want to ...</td>\n","      <td>negative</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>people want know like empty mall china coronav...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>RT @SenRubioPress Confirmed #coronavirus cases...</td>\n","      <td>neutral</td>\n","      <td>twitter.com</td>\n","      <td>00:04.0</td>\n","      <td>twitter</td>\n","      <td>confirmed coronavirus cases xinjiang highlight...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b0ee8ceb-7130-45cb-8273-287c8ea0a159')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-b0ee8ceb-7130-45cb-8273-287c8ea0a159 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-b0ee8ceb-7130-45cb-8273-287c8ea0a159');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":73}]},{"cell_type":"code","source":["df_result['Domain'] = df_predict[:1000]['Domain']\n","df_result['Date'] = df_predict[:1000]['Date']\n","df_result['Page Type'] = df_predict[:1000]['Page Type']\n","df_result['Sentiment'] = df_predict[:1000]['Sentiment']\n","\n","\n","df_result.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bqCEGzHNvojO","executionInfo":{"status":"ok","timestamp":1683584072254,"user_tz":300,"elapsed":292,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"0536d7db-94a6-4ef1-acef-c064bfdab18a"},"execution_count":74,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1000, 9)"]},"metadata":{},"execution_count":74}]},{"cell_type":"code","source":["df_result.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":250},"id":"iEuI-wizx_IG","executionInfo":{"status":"ok","timestamp":1683584074635,"user_tz":300,"elapsed":134,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}},"outputId":"02617596-7c24-492b-b76f-73c0936c52be"},"execution_count":75,"outputs":[{"output_type":"execute_result","data":{"text/plain":["   Country Character  Country Competence  People Character  People Competence  \\\n","0                  1                   1                 1                  1   \n","1                  1                   1                 1                  0   \n","2                  1                   0                 1                  1   \n","3                  1                   0                 1                  1   \n","4                  1                   1                 1                  0   \n","\n","                                               Tweet       Domain     Date  \\\n","0  amanpuri exchange highest referral fee industr...  twitter.com  00:23.0   \n","1  coronavirus spreads must continue take necessa...  twitter.com  00:22.0   \n","2  our sin accepted islam we re religious family ...  twitter.com  00:14.0   \n","3  people want know like empty mall china coronav...  twitter.com  00:14.0   \n","4  confirmed coronavirus cases xinjiang highlight...  twitter.com  00:04.0   \n","\n","  Page Type Sentiment  \n","0   twitter   neutral  \n","1   twitter   neutral  \n","2   twitter   neutral  \n","3   twitter  negative  \n","4   twitter   neutral  "],"text/html":["\n","  <div id=\"df-e02484f6-0d97-4da2-877d-195c929b4f05\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Country Character</th>\n","      <th>Country Competence</th>\n","      <th>People Character</th>\n","      <th>People Competence</th>\n","      <th>Tweet</th>\n","      <th>Domain</th>\n","      <th>Date</th>\n","      <th>Page Type</th>\n","      <th>Sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>amanpuri exchange highest referral fee industr...</td>\n","      <td>twitter.com</td>\n","      <td>00:23.0</td>\n","      <td>twitter</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>coronavirus spreads must continue take necessa...</td>\n","      <td>twitter.com</td>\n","      <td>00:22.0</td>\n","      <td>twitter</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>our sin accepted islam we re religious family ...</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>neutral</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>people want know like empty mall china coronav...</td>\n","      <td>twitter.com</td>\n","      <td>00:14.0</td>\n","      <td>twitter</td>\n","      <td>negative</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>confirmed coronavirus cases xinjiang highlight...</td>\n","      <td>twitter.com</td>\n","      <td>00:04.0</td>\n","      <td>twitter</td>\n","      <td>neutral</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e02484f6-0d97-4da2-877d-195c929b4f05')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e02484f6-0d97-4da2-877d-195c929b4f05 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e02484f6-0d97-4da2-877d-195c929b4f05');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":75}]},{"cell_type":"code","source":["# Generating output csv file\n","df_result.to_csv(\"/content/drive/MyDrive/Colab Notebooks/INFO_5731_Project/sentiment_output.csv\", index=False, \n","                 columns=['Date', 'Domain', 'Page Type', 'Tweet', 'Country Character', 'Country Competence', 'People Character', 'People Competence', 'Sentiment'])\n"],"metadata":{"id":"RrvBMeDyRYSS","executionInfo":{"status":"ok","timestamp":1683584088781,"user_tz":300,"elapsed":109,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":76,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"HZCUyRiaYq5E","executionInfo":{"status":"ok","timestamp":1683525166506,"user_tz":300,"elapsed":28,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":32,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"-rq5d1lmYs6D","executionInfo":{"status":"ok","timestamp":1683525166506,"user_tz":300,"elapsed":28,"user":{"displayName":"karthik puppala","userId":"18012933501446228483"}}},"execution_count":32,"outputs":[]}]}